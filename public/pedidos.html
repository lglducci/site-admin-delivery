 <!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Pedidos Atuais</title>
    <style>
      body {
        font-family: sans-serif;
        background: #f3f3f3;
        padding: 20px;
      }

      h1 {
        color: #333;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .pedido {
        background: white;
        margin: 10px 0;
        padding: 10px;
        border-left: 5px solid #007bff;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        border-radius: 6px;
      }

      .pedido.atrasado {
        border-left-color: red;
      }

      .numero {
        font-weight: bold;
        font-size: 18px;
      }

      .botao {
        margin-top: 8px;
        display: flex;
        gap: 10px;
      }

      button {
        padding: 5px 10px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        color: white;
      }

      .btn-avancar {
        background-color: #007bff;
      }

      .btn-cancelar {
        background-color: #dc3545;
      }
    </style>
  </head>
  <body>
    <h1>üì¶ Pedidos Atuais</h1>
    <div id="lista-pedidos">Carregando pedidos...</div>

    <script>
      const container = document.getElementById("lista-pedidos");

      fetch("https://webhook.lglducci.com.br/webhook/pedidos")
        .then((r) => r.json())
        .then((dados) => {
          container.innerHTML = "";

          if (!Array.isArray(dados) || dados.length === 0) {
            container.innerHTML = "Nenhum pedido encontrado.";
            return;
          }

          dados.forEach((pedido) => {
            const div = document.createElement("div");
            const dataPedido = new Date(pedido.data);
            const agora = new Date();
            const minutos = Math.floor((agora - dataPedido) / 60000);
            const atrasado = minutos > 15;

            div.className = "pedido" + (atrasado ? " atrasado" : "");

            div.innerHTML = `
              <div class="numero">üì¶ Pedido n¬∫ ${pedido.numero || "?"}</div>
              <div>üßë Cliente: ${pedido.nomeCliente || "Desconhecido"}</div>
              <div>üìÖ Data: ${isNaN(dataPedido) ? "Data inv√°lida" : dataPedido.toLocaleString("pt-BR")}</div>
              <div>‚è±Ô∏è ${atrasado ? "‚è∞ Pedido parado h√° mais de 15 minutos" : "Pedido recente"}</div>
              <div class="botao">
                <button class="btn-avancar" onclick="avancar(${pedido.numero})">Avan√ßar</button>
                <button class="btn-cancelar" onclick="cancelar(${pedido.numero})">Cancelar</button>
              </div>
            `;

            container.appendChild(div);
          });
        })
        .catch((err) => {
          container.innerText = "Erro ao carregar pedidos.";
          console.error(err);
        });

      function avancar(numero) {
        alert("Avan√ßar pedido: " + numero);
        // Aqui voc√™ pode fazer um fetch para seu webhook
      }

      function cancelar(numero) {
        alert("Cancelar pedido: " + numero);
        // Aqui voc√™ pode fazer um fetch para cancelar o pedido
      }
    </script>
  </body>
</html>
